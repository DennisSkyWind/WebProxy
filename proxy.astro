<astro>
---
const fetch = require('node-fetch');

export async function server(request, response) {
  const url = `https://${request.query.get('url')}`;
  const headers = Object.fromEntries(request.headers.entries());

  const res = await fetch(url, {
    method: request.method,
    headers,
    body: request.body,
  });

  const resHeaders = Object.fromEntries(res.headers.entries());

  response.status = res.status;
  response.headers = resHeaders;
  response.body = res.body;
}
---
</astro>
